\chapter{Estudi de la situació actual}
\section{Protocols i programaris existents}
Els protocols de seguretat poden proveir alguns dels serveis de seguretat aquí explicats:
\begin{itemize}
\item \textbf{Xifrar el tràfic} de manera que no pugi ser llegit per ningú més que pels destinataris originals.
\item \textbf{Validar la integritat} per assegurar que el tràfic no ha estat modificat durant el seu recorregut.
\item \textbf{Autenticar els extrems} per assegurar que el tràfic prové d'un extrem de confiança.
\item \textbf{Evitar el repudi} de l'altre extrem per tal de que no pugui negar haver enviat l'informació.
\item \textbf{Evitar la repetició} malintencionada de paquets (l'anti-repetició).
\end{itemize}

A continuació s'analitzaran alguns protocols i programaris existents.
\subsection{IPsec}
\keyword{IPsec}{Internet Protocol security} és d'ús opcional en \okeyword{IP}v4 i serà obligatori en IPv6. IPsec va ser creat per proporcionar seguretat en dos possibles modes. El mode de transport (extrem a extrem), en el que els ordenadors dels extrems finals realitzen el processat de seguretat del tràfic de paquets. El mode túnel (porta a porta) en el que la seguretat del tràfic de paquets és proporcionada a vàries màquines (inclús a tota la \okeyword{LAN}) per un únic node.

IPsec va ser introduït per proporcionar serveis de seguretat tals com: xifrar el tràfic, validar la integritat, autenticar als extrems i l'anti-repetició. L'ús principal d'IPsec és el de crear \okeyword{VPN}s en qualsevol dels dos modes, però les implicacions de seguretat són bastant diferents entre els dos modes d'operació.

La seguretat de comunicacions extrem a extrem a escala Internet és va desenvolupar més tard i utilitza la infraestructura de clau pública universal \keyword{DNSSEC}{Domain Name System Security Extensions}.

La majoria d'implementacions d'aquest protocol tenen problemes de compatibilitat amb les altres implementacions del mateix protocol, degut a que cada fabricant interpreta el \rfckeyword{} i s'adapta el protocol a la seva mida. L'ús de \okeyword{DNSSSEC} per a l'intercanvi de claus no es troba en gaires implementacions.

Així doncs depenent del nivell en el que actuï l'IPsec, aquest estarà treballant en mode transport o mode túnel.
\subsubsection{Mode transport}
En mode transport, només es xifra i/o autentica el \emph{payload} (la carga útil) del paquet \okeyword{IP}. Per tant al no tocar les capçaleres IP no afecta a l'enrutament, però si s'utilitza l'\keyword{AH}{Authentication Header} les direccions IP no poden ser traduïdes (com fa per exemple un \keyword{NAT}{Network Address Translator}) ja que això faria que el valor del \emph{hash} (resum) no coincidís. Aquest mode s'utilitza en comunicacions ordinador a ordinador.

Per tal de travessar els \okeyword{NAT}s s'ha definit en un \okeyword{RFC} com a mecanisme d'encapsulació de missatges IPsec anomanat \keyword{NAT-T}{NAT Traversal in the IKE}.
\subsubsection{Mode túnel}
En el mode túnel, es xifra i/o autentica tot el paquet IP sencer (capçalera inclusiva). Aquesta informació s'encapsula dins del \emph{payload} d'un nou paquet IP per tal de que pugui ser enrutat. Aquest mode s'utilitza en comunicacions xarxa a xarxa, per exemple per crear VPNs a través d'Internet.

\subsection{OpenVPN}
OpenVPN és un software de VPN a nivell d'aplicació, que fa ús del \emph{driver} genèric i multiplataforma \okeyword{TUN}/\okeyword{TAP}. Mijançant aquest \emph{driver} l'aplicació pot crear VPNs en dos modes:
\begin{itemize}
\item \textbf{Mode pont Ethernet}
Simula una interfície de xarxa \okeyword{Ethernet} i crea una VPN que treballa amb trames de capa 2 del \keywords{OSI}{model OSI}{Open Systems Interconnection - Basic Reference Model}.
\item \textbf{Mode túnel IP}
Simula una interfície de xarxa punt-a-punt i crea una VPN que treballa amb paquets de capa 3 del model OSI.
\end{itemize}

OpenVPN en mode pont Ethernet sempre utilitza una única interfície de xarxa en cada màquina per tota la VPN. Peró en el mode túnel IP pot treballar en diferents topologies internes:
\begin{itemize}
\item \textbf{p2p}: Utilitza una interfície de xarxa punt-a-punt al servidor per a cada client connectat, i el sistema operatiu del servidor s'encarrega de l'enrutat. Els clients només veuen el servidor i han d'utilitzar-lo com a \emph{router} per accedir a la resta de clients de la VPN. Aquest mode no és compatible amb les màquines que utilitzin Microsoft Windows.
\item \textbf{net30}: Utilitza una interfície de xarxa al servidor per a cada client connectat. Tant els clients com el servidor en les seves interfícies, utilitzen subxarxes /30 i per tant el sistema operatiu del servidor també s'encarrega de l'enrutat. Els clients segueixen veient només al servidor i han d'utilitzar-lo com a \emph{router} per accedir a la resta de clients de la VPN. Aquest mode és compatible amb les màquines que utilitzin Microsoft Windows.
\item \textbf{subnet}: Utilitza una única interfície de xarxa en cada màquina per tota la VPN, com en el mode \okeyword{Ethernet}. Per tant, és l'aplicació qui s'encarrega de l'enrutat de la VPN.
\end{itemize}

L'aplicació te diferents modes de funcionament:
\begin{itemize}
\item \textbf{Mode punt-a-punt}: Crea una VPN amb només 2 extrems.
\item \textbf{Mode servidor}: Permet que se li connectin varis clients.
\item \textbf{Mode client}: Permet connectar-se al servidor.
\end{itemize}
Per tant podem dir que és tracta d'una aplicació de VPNs centralitzades tal com es mostra en la figura \ref{F:vpn-centralized}.
\begin{figure}[htb]
\centering
\includegraphics[height=0.5\textwidth]{images/vpn-centralized}
\caption{Topologia d'una VPN centralitzada}
\label{F:vpn-centralized}
\end{figure}

A nivell de seguretat utilitza l'estàndard \keyword{TLS}{Transport Layer Security}

\clearpage%optional
\subsection{TincVPN}
TincVPN és un software de \okeyword{VPN} a nivell d'aplicació, que fa ús del \emph{driver} genèric i multiplataforma \okeyword{TUN}/\okeyword{TAP}. Mitjançant aquest \emph{driver} l'aplicació pot crear VPNs en \textbf{mode pont Ethernet} o en \textbf{mode túnel IP}, ja explicats anteriorment. L'aplicació crea una VPN mallada (figura \ref{F:vpn-meshed}) connectant-se a una llista de \emph{peers}, i la resta de \emph{peers} de la VPN hauran de ser enrutats a través d'altres \emph{peers} per arribar als nodes que no tinguin connexió directe.
\begin{figure}[htb]
\centering
\includegraphics[height=0.5\textwidth]{images/vpn-meshed}
\caption{Topologia d'una VPN mallada}
\label{F:vpn-meshed}
\end{figure}

Utilitza una única interfície de xarxa en cada màquina per tota la VPN, com en el mode \emph{subnet} de OpenVPN. Per tant, és l'aplicació qui s'encarrega del \emph{bridging} (en mode pont Ethernet) o de l'enrutat (en mode túnel IP) de la VPN.

A nivell de seguretat utilitza un protocol propi \keyword{RSA}{Algoritme criptogràfic}.

\subsection{Wippien}
\begin{figure}[htb]
\centering
\includegraphics[height=0.5\textwidth]{images/vpn-externalized}
\caption{Topologia d'una VPN amb autenticació externa}
\label{F:vpn-externalized}
\end{figure}

\subsection{Hamachi}

\subsection{ELA VPN}
\keyword{ELA}{Everywhere Local Area network} és un software de VPN a nivell d'aplicació.
Utilitza una topologia de nodes mallada (figura \ref{F:vpn-meshed}) connectada tant amb túnels TCP com UDP.
D'aquesta VPN no s'ha trobat cap implementació, el \emph{paper} descriptiu es troba adjunt als annexos.
\section{Comparativa}
