\chapter{Estudi de la situació actual}
\section{Protocols i programaris existents}
Els protocols de seguretat poden proveir alguns dels serveis de seguretat aquí explicats:
\begin{itemize}
\item \textbf{Xifrar el tràfic} de manera que no pugi ser llegit per ningú més que les parts a les que s'està dirigint.
\item \textbf{Validació de la integritat} per assegurar que el tràfic no ha estat modificat durant el seu recorregut.
\item \textbf{Autenticar els extrems} per assegurar que el tràfic prové d'un extrem de confiança.
\item \textbf{Evitar el repudi} de l'altre extrem per tal de que no pugui negar haver enviat l'informació.
\item \textbf{Anti-repetició} per protegir-se contra la repetició malintencionada de paquets.
\end{itemize}

A continuació s'analitzaran alguns protocols i programaris existents.
\subsection{IPsec}
\keyword{IPsec}{Internet Protocol security} és d'ús opcional en IPv4 i serà una obligatori en IPv6. IPsec va ser creat per proporcionar seguretat en mode de transport (extrem a extrem) del tràfic de paquets, en el que els ordenadors dels extrems finals realitzen el processat de seguretat, o en mode túnel (porta a porta) en el que la seguretat del tràfic de paquets es proporcionada a vàries màquines (inclús a tota la LAN) per un únic node.

L'ús principal d'IPsec és el de crear VPNs en qualsevol els dos modes. Però les implicacions de seguretat són bastant diferents entre els dos modes d'operació.

La seguretat de comunicacions extrem a extrem a escala Internet és va desenvolupar més tard i utilitza l'infraestructura de clau pública universal \keyword{DNSSEC}{Domain Name System Security Extensions}.

IPsec va ser introduït per proporcionar serveis de seguretat tals com: xifrar el tràfic, validació d'integritat, autenticar als extrems i anti-repetició.

La majoria de implementacions d'aquest protocol té problemes de compatibilitat amb les altres implementacions del mateix protocol degut a que cada fabricant interpreta el \rfckeyword i peculiaritza el protocol a la seva mida. L'ús de DNSSSEC per l'intercanvi de claus no es troba en gaires implementacions.

Així doncs depenent del nivell en el que actuï l'IPsec, aquest estarà treballant en mode transport o mode túnel.
\subsubsection{Mode transport}
En mode transport, només es xifra i/o autentica el \emph{payload} (la carga útil) del paquet IP. Per tant al no tocar les capçaleres IP no afecta al enrutament, però si s'utilitza l'\keyword{AH}{Authentication Header} les direccions IP no poden ser traduïdes (com fa per exemple un \keyword{NAT}{Network Address Translator}) ja que això faria que el valor del \emph{hash} (resum) no coincidís. Aquest mode s'utilitza en comunicacions ordinador a ordinador.

Una forma d'encapsular missatges IPsec per travessar NATs s'ha definit en un un RFC com a mecanisme \keyword{NAT-T}{NAT Traversal in the IKE}.
\subsubsection{Mode túnel}
En el mode túnel, es xifra i/o autentica tot el paquet IP sencer (capçalera inclusiva). Aquesta informació s'encapsula dins del \emph{payload} d'un nou paquet IP per tal de que pugui ser enrutat. Aquest mode s'utilitza en comunicacions xarxa a xarxa, per exemple per crear VPNs a traves d'Internet.

\subsection{OpenVPN}
OpenVPN es un software de VPN a nivell de aplicació que fa ús del \emph{driver} genèric i multiplataforma \okeyword{TUN}/\okeyword{TAP}. La mijançant aquest \emph{driver} l'aplicació pot crear VPNs en dos modes:
\begin{itemize}
\item \textbf{Mode pont Ethernet}
Simula una interfície de xarxa \okeyword{Ethernet} i crea una VPN que treballa amb trames de capa 2 del \keywords{OSI}{model OSI}{Open Systems Interconnection - Basic Reference Model}.
\item \textbf{Mode túnel IP}
Simula una interfície de xarxa punt-a-punt i crea una VPN que treballa amb trames de capa 3 del model OSI.
\end{itemize}

OpenVPN en mode pont Ethernet sempre utilitza una única interfície de xarxa en cada màquina per tota la VPN. Peró en el mode túnel IP pot treballar en diferents modes de topologia:
\begin{itemize}
\item \textbf{Mode p2p} Utilitza una interfície de xarxa punt-a-punt al servidor per a cada client connectat i el sistema operatiu del servidor s'encarrega del enrutat. Els clients només veuen el servidor i han d'utilitzar-lo com a \emph{router} per accedir a la resta de clients de la VPN. Aquest mode no és compatible amb els màquines que utilitzin Microsoft Windows.
\item \textbf{Mode net30} Utilitza una interfície de xarxa al servidor per a cada client connectat. Tant els clients com el servidor en les seves interfícies utilitzen subxarxes /30 i per tant el sistema operatiu del servidor també s'encarrega del enrutat. Els clients segueixen veient només al servidor i han d'utilitzar-lo com a \emph{router} per accedir a la resta de clients de la VPN. Aquest mode és compatible amb els màquines que utilitzin Microsoft Windows.
\item \textbf{Mode subnet} Utilitza una única interfície de xarxa en cada màquina per tota la VPN com en el mode Ethernet. És per tant l'aplicació qui s'encarrega del enrutat de la VPN.
\end{itemize}

L'aplicació te diferents modes de funcionament:
\begin{itemize}
\item \textbf{Mode punt-a-punt} Crea una VPN amb només 2 extrems.
\item \textbf{Mode servidor} Permet que se li connectin varis clients.
\item \textbf{Mode client} Permet connectar-se al servidor.
\end{itemize}
Per tant podem dir que és tracta d'una aplicació de VPNs centralitzades tal com es mostra en la figura \ref{F:vpn-centralized}.
\begin{figure}[htb]
\centering
\includegraphics[height=0.5\textwidth]{images/vpn-centralized}
\caption{Topologia d'una VPN centralitzada}
\label{F:vpn-centralized}
\end{figure}

A nivell de seguretat utilitza l'estàndard \keyword{TLS}{Transport Layer Security}

\clearpage%optional
\subsection{TincVPN}
TincVPN es un software de VPN a nivell de aplicació que fa ús del \emph{driver} genèric i multiplataforma \okeyword{TUN}/\okeyword{TAP}. La mijançant aquest \emph{driver} l'aplicació pot crear VPNs en \textbf{mode pont Ethernet} o en \textbf{mode túnel IP} ja explicats anteriorment. La aplicació crea una VPN mallada (figura \ref{F:vpn-meshed}) connectant-se a una llista de \emph{peers}, la resta de \emph{peers} de la VPN hauran de ser enrutats a través de altres \emph{peers} per arribar als nodes que no tinguin connexió directe.
\begin{figure}[htb]
\centering
\includegraphics[height=0.5\textwidth]{images/vpn-meshed}
\caption{Topologia d'una VPN mallada}
\label{F:vpn-meshed}
\end{figure}

Utilitza una única interfície de xarxa en cada màquina per tota la VPN, com en el mode \emph{subnet} de OpenVPN. És, per tant, l'aplicació qui s'encarrega del \emph{bridging} (en mode pont Ethernet) o del enrutat (en mode túnel IP) de la VPN.

A nivell de seguretat utilitza un protocol propi \keyword{RSA}{Algoritme criptogràfic}.

\subsection{Wippien}
\begin{figure}[htb]
\centering
\includegraphics[height=0.5\textwidth]{images/vpn-externalized}
\caption{Topologia d'una VPN amb autenticació externa}
\label{F:vpn-externalized}
\end{figure}

\subsection{Hamachi}

\subsection{ELA VPN}
\keyword{ELA}{Everywhere Local Area network} es un software de VPN a nivell de aplicació.
Utilitza una topologia de nodes mallada (figura \ref{F:vpn-meshed}) connectada tant amb túnels TCP com UDP.
D'aquesta VPN no s'ha trobat cap implementació, el \emph{paper} descriptiu està adjuntat als annexos.
\section{Comparativa}
